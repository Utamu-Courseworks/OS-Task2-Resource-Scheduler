<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Performance Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>System Performance Dashboard</h1>
    <canvas id="agentChart"></canvas>
    <canvas id="performanceChart"></canvas>
    
    <script>
        function fetchData() {
            fetch('/status')
                .then(response => response.json())
                .then(data => {
                    updateAgentChart(data.agents);
                });
            
            fetch('/performance')
                .then(response => response.json())
                .then(data => {
                    updatePerformanceChart(data.avg_wait_time, data.utilization);
                });
        }

        function updateAgentChart(agents) {
            const labels = agents.map(a => `Agent ${a.id}`);
            const tasks = agents.map(a => a.tasks);
            agentChart.data.labels = labels;
            agentChart.data.datasets[0].data = tasks;
            agentChart.update();
        }

        function updatePerformanceChart(waitTime, utilization) {
            performanceChart.data.datasets[0].data = [waitTime, utilization];
            performanceChart.update();
        }

        const agentChart = new Chart(document.getElementById('agentChart'), {
            type: 'bar',
            data: {
                labels: [],
                datasets: [{
                    label: 'Tasks Assigned',
                    data: [],
                    backgroundColor: 'blue'
                }]
            }
        });

        const performanceChart = new Chart(document.getElementById('performanceChart'), {
            type: 'pie',
            data: {
                labels: ['Avg Wait Time', 'Agent Utilization'],
                datasets: [{
                    data: [],
                    backgroundColor: ['red', 'green']
                }]
            }
        });

        setInterval(fetchData, 5000);
    </script>
</body>
</html>
